services:
  homassy.api:
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ConnectionStrings__DefaultConnection=${DB_CONNECTION_STRING}
      - Jwt__SecretKey=${JWT_SECRET_KEY}
      - Jwt__Issuer=Homassy.API
      - Jwt__Audience=Homassy.Client
      - Jwt__AccessTokenExpirationMinutes=15
      - Jwt__RefreshTokenExpirationDays=7
      - Cors__AllowedOrigins__0=http://localhost:3000
      - Logging__LogLevel__Default=Information
      - Logging__LogLevel__Microsoft.AspNetCore=Warning
    volumes:
      - ./Homassy.API:/src/Homassy.API:ro
      - ./Homassy.API/Logs:/app/Logs

  homassy.web:
    environment:
      - NODE_ENV=development
      - NUXT_PUBLIC_API_BASE=http://homassy.api:8080
    volumes:
      - ./Homassy.Web:/app
      - /app/node_modules
      - /app/.nuxt
    command: npm run dev -- --host 0.0.0.0
